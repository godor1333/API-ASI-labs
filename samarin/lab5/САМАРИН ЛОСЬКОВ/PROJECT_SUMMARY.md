# Краткое описание реализации проекта

## Что реализовано

### 1. Backend генерации видео (`backend/`)

- **`video_generator.py`** - Основной модуль генерации видео из текста
  - Парсинг текстового описания на сцены
  - Генерация ключевых кадров через SDXL
  - Генерация клипов через Stable Video Diffusion
  - Склейка клипов в финальное видео

- **`keyframe_generator.py`** - Генератор ключевых кадров
  - Поддержка SDXL для генерации кадров
  - Fallback на stub-кадры при отсутствии модели
  - Сохранение ключевых кадров

- **`comfyui_client.py`** - Клиент для работы с ComfyUI
  - WebSocket подключение к ComfyUI
  - Отправка workflow для генерации
  - Получение результатов генерации

### 2. Webench2 интеграция (`webench2/`)

- **`evaluator.py`** - Основной оценщик видео
  - Извлечение кадров из видео
  - Вычисление всех метрик
  - Сохранение результатов

- **`metrics.py`** - Калькулятор метрик
  - CLIPScore для соответствия тексту
  - ImageReward для визуального качества
  - Проверки на статичные, тёмные, пересвеченные кадры
  - Обнаружение скачков яркости

- **`benchmark.py`** - Регрессионный бенчмарк
  - Запуск на наборе эталонных промптов
  - Сводная статистика
  - A/B сравнение моделей

### 3. Эталонные промпты (`prompts/`)

- **`benchmark_prompts.json`** - Набор из 20 промптов
  - Разные категории: character, action, abstract, interface, nature, urban, fantasy, sci_fi, minimal
  - Покрытие различных сценариев генерации

### 4. Веб-интерфейс (`frontend/`)

- **`app.py`** - Flask приложение с API
  - Список видео и метрик
  - Просмотр результатов бенчмарков
  - Сравнение моделей
  - Сводная аналитика

- **`templates/index.html`** - Веб-интерфейс
  - Вкладки для разных разделов
  - Визуализация метрик
  - Просмотр видео с оценками

### 5. Конфигурация (`config/`)

- **`config.yaml`** - Централизованная конфигурация
  - Настройки ComfyUI
  - Параметры моделей
  - Параметры генерации
  - Настройки Webench2

### 6. Утилиты

- **`main.py`** - Главный скрипт с CLI интерфейсом
- **`run_benchmark.py`** - Быстрый запуск бенчмарка
- **`run_web.py`** - Запуск веб-интерфейса
- **`example_usage.py`** - Примеры использования

## Соответствие ТЗ

✅ **Генерация видео из текста** - реализовано через пайплайн SDXL → SVD  
✅ **Интеграция с ComfyUI** - клиент для работы через WebSocket API  
✅ **Оценка через Webench2** - полный набор метрик (CLIPScore, ImageReward, технические проверки)  
✅ **Регрессионный бенчмарк** - запуск на эталонных промптах с сохранением результатов  
✅ **A/B сравнение моделей** - сравнение двух версий с дельтами метрик  
✅ **Веб-интерфейс аналитики** - визуализация результатов и метрик  

## Особенности реализации

1. **Модульная архитектура** - каждый компонент независим и может использоваться отдельно
2. **Fallback механизмы** - stub-кадры при отсутствии моделей, упрощённая оценка ImageReward
3. **Гибкая конфигурация** - все параметры в YAML файле
4. **Расширяемость** - легко добавить новые метрики или модели

## Что можно улучшить

1. **Реальная интеграция ImageReward** - сейчас используется упрощённая эвристика
2. **Оптимизация ComfyUI workflow** - более детальная настройка параметров SVD
3. **Кэширование результатов** - для ускорения повторных оценок
4. **Параллельная обработка** - генерация нескольких видео одновременно
5. **Более сложный парсинг сцен** - использование NLP для разбиения текста

## Зависимости

Все зависимости указаны в `requirements.txt`. Основные:
- PyTorch для работы с моделями
- Transformers для CLIP
- OpenCV для обработки видео
- Flask для веб-интерфейса
- ComfyUI (устанавливается отдельно)

## Использование

См. `README.md` и `INSTALL.md` для подробных инструкций.
