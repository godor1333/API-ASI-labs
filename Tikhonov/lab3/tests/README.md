# Тесты Selenium для Генератора мемов

Комплексные тесты, покрывающие весь функционал веб-приложения генератора мемов.

## Структура

- `test_meme_generator.py` - Все тесты в одном файле
- `conftest.py` - Конфигурация и фикстуры для pytest
- `requirements.txt` - Зависимости для тестов

## Установка

```bash
cd tests
pip install -r requirements.txt
```

## Запуск тестов

### Предварительные требования

1. Приложение должно быть запущено:
   ```bash
   docker-compose up
   ```

2. Приложение должно быть доступно на `http://localhost`

### Запуск всех тестов

```bash
# Из корневой директории проекта
pytest tests/test_meme_generator.py -v

# С подробным выводом
pytest tests/test_meme_generator.py -v -s

# С выводом в консоль
pytest tests/test_meme_generator.py -v --capture=no
```

### Запуск конкретного теста

```bash
pytest tests/test_meme_generator.py::TestMemeGenerator::test_01_registration_and_login -v
```

### Запуск с настройкой URL

```bash
BASE_URL=http://your-url pytest tests/test_meme_generator.py -v
```

## Покрытие тестов

### 1. Регистрация и вход (test_01)
- Регистрация нового пользователя
- Вход в систему
- Проверка отображения имени пользователя

### 2. Загрузка изображения (test_02)
- Загрузка тестового изображения
- Проверка успешной загрузки
- Проверка появления секции создания мема

### 3. Создание мема с текстом (test_03)
- Ввод текста для мема
- Создание мема
- Проверка успешного создания и превью

### 4. Кнопки выравнивания текста (test_04)
- Проверка наличия кнопок выравнивания
- Проверка активности кнопки по умолчанию
- Переключение между выравниваниями

### 5. Добавление нескольких текстов (test_05)
- Добавление дополнительного текстового поля
- Проверка наличия кнопок выравнивания для каждого поля
- Ввод текста в несколько полей

### 6. Создание мема с разным выравниванием (test_06)
- Создание мема с текстами, выровненными по-разному
- Проверка успешного создания

### 7. Просмотр списка мемов (test_07)
- Проверка отображения списка мемов
- Проверка наличия созданных мемов

### 8. Выход из системы (test_08)
- Выход из системы
- Проверка возврата к форме входа
- Проверка скрытия основного контента

## Особенности

- **Полная изоляция**: каждый тест открывает и закрывает браузер отдельно
- **Автоматическая очистка**: localStorage очищается перед каждым тестом
- **Уникальные пользователи**: каждый тест создает уникального пользователя
- **Покрытие всего функционала**: регистрация, вход, загрузка, создание мемов, выравнивание текста

## Настройка

### Headless режим

Для запуска тестов в headless режиме (без открытия браузера), раскомментируйте строку в `conftest.py`:

```python
chrome_options.add_argument("--headless")
```

### Таймауты

Таймауты можно настроить в `conftest.py`:
- `driver.implicitly_wait(10)` - неявное ожидание элементов
- `WebDriverWait(driver, 15)` - явное ожидание элементов

## Скриншоты при ошибках

При падении теста можно добавить автоматическое сохранение скриншотов. Для этого добавьте в `conftest.py`:

```python
@pytest.hookimpl(tryfirst=True, hookwrapper=True)
def pytest_runtest_makereport(item, call):
    outcome = yield
    rep = outcome.get_result()
    if rep.when == "call" and rep.failed:
        driver = item.funcargs.get('driver')
        if driver:
            screenshot_dir = "screenshots"
            os.makedirs(screenshot_dir, exist_ok=True)
            screenshot_path = os.path.join(screenshot_dir, f"{item.name}.png")
            driver.save_screenshot(screenshot_path)
```

## Требования

1. Python 3.8+
2. Chrome браузер установлен
3. Приложение запущено на `http://localhost`
4. Все зависимости установлены (`pip install -r requirements.txt`)

